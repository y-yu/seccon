とりあえず、直ちにメールが届くことはなかった。
まあ何かの理由で遅れているという可能性もあるので、
しばらく待機する他ない。
現在は\Marsの他に\Uranusや\Neptuneなどいくつかの問題が追加されているが、
Web系の問題以外を解く脳がないので仕方なく既に制圧した\Mercuryを哨戒する。
俺が\Marsにチャレンジしている間、\Mercuryはキーワードこそいくつか取られたものの、
FLAGは死守している。

ただ、\mofuppが\Uranusのキーワードを立て続けに二つ取って\urandomを脅かす。
\mofuppは横浜大会で準優勝したチームで、
おーぴーの調べによるとksnctf\footnote{Webに公開されたCTFのサイト。\url{http://ksnctf.sweetduet.info/}}%
の作者がいるという話だ。
ksnctfはおーぴーの勧めで少しやってみたが、正直言って全然分からなかった。
俺を基準に話を進めるのも極端だが、かなりレベルの高い人間が少なくとも一人は所属しているのだろう。

その後様々なチームが\Uranusを攻め立てて\urandomに迫るも、
すかさずおーぴー達が\Uranusのキーワードを2つとも取得し点差を戻す。
そして\Mercuryから得られる税収でじわりじわりと逃げる。

とりあえず\Mercuryの\ctt{authorized\_keys}を見ると、
もはや先ほどとは比べものにならない程に巨大なファイルになっていた。
やはり一秒ごとに\ctt{images}の中身を消すといっても、所詮は一秒ごとだ。
\ctt{wget}か何かそういうプログラムを使ってひたすらPHPファイルをアップロードし続けて、
アップロード予定のアドレスにひたすらF5を押し続ければいずれPHPファイルが実行されてしまうだろう。
とはいえ所詮はキーワードが一つ取られる程度だ。
%今\urandomは一位を独走状態、二位の集団に700ポイント程度の差をつけている。
キーワード一つ程度ならば問題はない。
\Mercuryからの税収で、そんなものは20分で処理出来る。

さてメールが届いたかどうかを確認しようか、などと思った時、
久しく聞いていなかった長いサイレン音が響く。

うっ……！
祗園精舎の鐘の声、
諸行無常の響きあり。
ついに\Mercuryの牙城を穿つものが来たか。

スコアを確認すると、どうやら\ZxZが\MercuryのFLAGに到達したらしい。
\ZxZは確かどこかの高専と筑駒の連中が混ったチームだったはず。
\EDと同様全員がキャンプ出身であり、横浜大会では三位だった。
\ZxZはちょっと覚えている、
USBの通信をキャプチャしたファイルからディスクイメージを再構築する
という異端な方法を取った人間がいたはずだ。
そして筑駒と言えばJOI。
確か、予選突破者が\ZxZにもいたような気がする。
全くどれだけデラックスなチームなんだか。

しかしおーぴーがプログラムでSSH接続を殺してるというのに、
彼らはどうやって侵入したのだろうか。

「フラッグワードで得られるポイントが減った」

ゆにゃが言う。

「20ポイントから10ポイントになっている」

これは……どうやら城下町が生み出す税は一定らしいな。
つまりフラッグワードを書き込むことによって得られるポイントは、
1チームしかいないのであれば20ポイント、2チームならば10ポイント、
$N$チームなら$\frac{20}{N}$ポイントという具合になっているのだろう。

その直後\MMAと\wasamusumeも\MercuryのFLAGに書き込む。
うっ、五分毎に20ポイントだったものが一瞬で5ポイントまで低下した。
くっ、これは痛いな。

\MMAはつくば大会で三位だった電通大のチームで、
\wasamusumeは確か横浜大会で優勝したチームだったはずだ。
\wasamusumeにはめいすの知り合いと思われる人間がいる。
TypeScriptを使うなどしてMicrosoftへの忠誠を示すめいすと同様に、
その知人というのもMicrosoft信者で、
横浜大会では当時ベータ版しかなかったWindows 8向けのバイナリファイルをその人が解析していた記憶がある。

やはり\wasamusumeや\MMAなど常連は強い。
しかし、
まだおーぴーとめいすの妨害プログラム、ゆにゃのフラッグワード書き込みという連携で三時間ほどかけて
営々蓄えた財産が800ポイントくらいある。
そう簡単に逆転などなかろう。

さて敵チームに這い寄られて精神力が低下する前に、
こちらがさらに点差を広げて敵の精神力を破壊したい所だ。
とりあえず先ほどメールヘッダ汚染を仕掛けた\Marsだが、
メールはまだ届いていない。
これは攻撃が失敗したと考えるしかあるまい。
となると、やはりメールヘッダ汚染は不可能なのであろうか。

「吉村君」

薄井くん\footnote{情報科学類二年次、ガチチャリ勢。}%
に話しかけられた。
彼もめいす同様この全国大会に合わせて追加したメンバーで、とりあえずLISP信者。

「今ポートスキャンしたんだけど、なんか22番ポートが開いてる」

22番といえばSSHだ。

「パスワード認証みたい」

聞き耳を立てていたおーぴーが追加する。
これは……メールヘッダ汚染の可能性が出てきたぞ。
今までの状況では仮にメールヘッダ汚染が成功したとしても、
その先どうやってFLAGに書き込めばいいのか見当がつかなかったが、
SSHがあるのであれば話は別だ。
つまり送信されるメールにSSHのユーザーとパスワードが付いていて、
そのメールをヘッダ汚染でこちらに引っ張ることでSSHにログイン出来るようになる。
そしてSSHでログインしてからは何か別の障壁が用意されている、というパターンだ。
占領している\Mercuryも途中からSSHを絡めていたし、これはワンチャンスあるはず。

だが先ほどの攻撃は失敗した。
これはメールヘッダ汚染の失敗とも考えられるが、
競技という性質上の問題ではないかという推論も出来る。
というのも競技故に、問題の置いてあるサーバー、つまりは\Marsを外部へ接続する訳にはいかなった。
しかしこの\ctt{message.cgi}にはメールヘッダ汚染の脆弱性があり、かつ\MarsはLANには接続されている。
従ってLAN内のどこか------例えば俺のコンピュータにメールサーバーを設置すればそこにメールが届くという可能性がありえる。
ただ問題は今\MarsのIPアドレスは\url{10.0.2.5}だが、
俺に割り振られたIPアドレスは\url{192.168.7.4}だ。
ネットワークのことはよく分からないが、こういうネットワーク構成で本当に到達出来るのだろうか。
それに俺はメールサーバーを構築した経験などないので、
どのようにすればいいのかさっぱり分からない。

仕方ない……。
一旦この手法は見送ろう。
明日までにメールサーバーを用意するしかあるまい。
メールのような一般的なシステムであれば、たぶんCPANなど様々な選択肢があるだろう。

